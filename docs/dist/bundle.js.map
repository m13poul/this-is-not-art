{
  "version": 3,
  "sources": ["../main.ts"],
  "sourcesContent": ["// --- Mondrian Generation Logic (Browser-compatible) ---\n\ninterface Block {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nconst PRIMARY_COLORS = [\"#FF0000\", \"#0000FF\", \"#FFFF00\"]; // Red, Blue, Yellow\nconst BACKGROUND_COLOR = \"#FFFFFF\"; // White\nconst MIN_BLOCK_SIZE = 150; // Adjusted for smaller web canvas\n\nfunction generateBlocks(\n  block: Block,\n  depth: number,\n  maxDepth: number\n): Block[] {\n  if (depth >= maxDepth) {\n    return [block];\n  }\n\n  if (\n    (block.width < MIN_BLOCK_SIZE && block.height < MIN_BLOCK_SIZE) ||\n    (Math.random() < 0.2 && depth > 0)\n  ) {\n    return [block];\n  }\n\n  const splitHorizontally = block.height > block.width;\n  const splitVertically = block.width > block.height;\n  let blocks: Block[] = [];\n\n  if (splitHorizontally && block.height > MIN_BLOCK_SIZE) {\n    const splitPoint = Math.floor(\n      block.y + block.height * (Math.random() * 0.4 + 0.3)\n    );\n    const blockA: Block = {\n      x: block.x,\n      y: block.y,\n      width: block.width,\n      height: splitPoint - block.y,\n    };\n    const blockB: Block = {\n      x: block.x,\n      y: splitPoint,\n      width: block.width,\n      height: block.y + block.height - splitPoint,\n    };\n\n    blocks = [\n      ...generateBlocks(blockA, depth + 1, maxDepth),\n      ...generateBlocks(blockB, depth + 1, maxDepth),\n    ];\n  } else if (splitVertically && block.width > MIN_BLOCK_SIZE) {\n    const splitPoint = Math.floor(\n      block.x + block.width * (Math.random() * 0.4 + 0.3)\n    );\n    const blockA: Block = {\n      x: block.x,\n      y: block.y,\n      width: splitPoint - block.x,\n      height: block.height,\n    };\n    const blockB: Block = {\n      x: splitPoint,\n      y: block.y,\n      width: block.x + block.width - splitPoint,\n      height: block.height,\n    };\n\n    blocks = [\n      ...generateBlocks(blockA, depth + 1, maxDepth),\n      ...generateBlocks(blockB, depth + 1, maxDepth),\n    ];\n  } else {\n    blocks = [block];\n  }\n\n  return blocks;\n}\n\nfunction drawComposition(\n  ctx: CanvasRenderingContext2D,\n  blocks: Block[],\n  colorChance: number,\n  lineWeight: number\n): void {\n  // Fill blocks\n  for (const block of blocks) {\n    if (Math.random() < colorChance) {\n      const colorIndex = Math.floor(Math.random() * PRIMARY_COLORS.length);\n      ctx.fillStyle = PRIMARY_COLORS[colorIndex];\n    } else {\n      ctx.fillStyle = BACKGROUND_COLOR;\n    }\n    ctx.fillRect(block.x, block.y, block.width, block.height);\n  }\n\n  // Draw grid\n  ctx.strokeStyle = \"#000000\";\n  ctx.lineWidth = lineWeight;\n  ctx.lineCap = \"butt\";\n  ctx.lineJoin = \"miter\";\n\n  for (const block of blocks) {\n    ctx.strokeRect(block.x, block.y, block.width, block.height);\n  }\n}\n\nconst randInt = (min: number, max: number) =>\n  Math.floor(Math.random() * (max - min + 1)) + min;\nconst randFloat = (min: number, max: number) =>\n  Math.random() * (max - min) + min;\n\n// --- Tone Generator with Mondrian Sync ---\n\nclass ToneGenerator {\n  private audioContext: AudioContext;\n  private isRunning: boolean = false;\n  private intervalId: number | null = null;\n  private canvas: HTMLCanvasElement;\n  private ctx: CanvasRenderingContext2D;\n  private volume: number = 0.1; // Default 40%\n  private interval: number = 1000; // Default 5 seconds\n\n  constructor(canvas: HTMLCanvasElement) {\n    this.audioContext = new (window.AudioContext ||\n      (window as any).webkitAudioContext)();\n    this.canvas = canvas;\n    this.ctx = canvas.getContext(\"2d\")!;\n\n    // Set canvas size\n    this.canvas.width = 1920;\n    this.canvas.height = 1080;\n  }\n\n  private generateMondrianImage(): void {\n    const maxDepth = randInt(4, 6);\n    const colorChance = randFloat(0.2, 0.4);\n    const lineWeight = randInt(12, 30);\n\n    // Clear canvas\n    this.ctx.fillStyle = BACKGROUND_COLOR;\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n    // Generate blocks\n    const initialBlock: Block = {\n      x: 0,\n      y: 0,\n      width: this.canvas.width,\n      height: this.canvas.height,\n    };\n    const finalBlocks = generateBlocks(initialBlock, 0, maxDepth);\n\n    // Draw composition\n    drawComposition(this.ctx, finalBlocks, colorChance, lineWeight);\n  }\n\n  private playTone(frequency: number, duration: number): void {\n    const oscillator = this.audioContext.createOscillator();\n    const gainNode = this.audioContext.createGain();\n\n    oscillator.type = \"sine\";\n    oscillator.frequency.setValueAtTime(\n      frequency,\n      this.audioContext.currentTime\n    );\n\n    // Use the volume property\n    gainNode.gain.setValueAtTime(this.volume, this.audioContext.currentTime);\n\n    oscillator.connect(gainNode);\n    gainNode.connect(this.audioContext.destination);\n\n    oscillator.start();\n    oscillator.stop(this.audioContext.currentTime + duration);\n  }\n\n  private playCombinationOfTones(duration: number): void {\n    const frequencies = [this.getRandomFrequency(), this.getRandomFrequency()];\n    console.log(\n      `Playing combination of tones at ~${Math.round(\n        frequencies[0]\n      )}Hz and ~${Math.round(frequencies[1])}Hz`\n    );\n    frequencies.forEach((freq) => this.playTone(freq, duration));\n  }\n\n  private getRandomFrequency(): number {\n    // Frequency range from A3 (220 Hz) to A5 (880 Hz)\n    return Math.random() * (880 - 220) + 220;\n  }\n\n  private generateSoundAndImage(): void {\n    // Generate new Mondrian image\n    this.generateMondrianImage();\n\n    // Play sound\n    const shouldPlayCombination = Math.random() > 0.5;\n    if (shouldPlayCombination) {\n      this.playCombinationOfTones(5);\n    } else {\n      const freq = this.getRandomFrequency();\n      console.log(`Playing single tone at ~${Math.round(freq)}Hz`);\n      this.playTone(freq, 5);\n    }\n  }\n\n  public setVolume(volumePercent: number): void {\n    // Convert percentage (0-100) to gain value (0-1)\n    this.volume = volumePercent / 100;\n    console.log(`Volume set to ${volumePercent}%`);\n  }\n\n  public setInterval(seconds: number): void {\n    this.interval = seconds * 1000; // Convert to milliseconds\n    console.log(`Speed set to ${seconds} seconds`);\n\n    // If already running, restart the interval with new timing\n    if (this.isRunning && this.intervalId !== null) {\n      clearInterval(this.intervalId);\n      this.intervalId = window.setInterval(\n        () => this.generateSoundAndImage(),\n        this.interval\n      );\n    }\n  }\n\n  public async start(): Promise<void> {\n    // Resume the AudioContext if it's suspended (which it will be on page load)\n    if (this.audioContext.state === \"suspended\") {\n      await this.audioContext.resume();\n    }\n\n    if (this.isRunning) return;\n    this.isRunning = true;\n    console.log(\n      `Audio and visual engine started. Generating every ${\n        this.interval / 1000\n      } seconds.`\n    );\n\n    this.generateSoundAndImage(); // Play the first tone and show first image immediately\n    this.intervalId = window.setInterval(\n      () => this.generateSoundAndImage(),\n      this.interval\n    );\n  }\n\n  public stop(): void {\n    if (!this.isRunning || this.intervalId === null) return;\n    this.isRunning = false;\n    clearInterval(this.intervalId);\n    this.intervalId = null;\n    console.log(\"Audio engine stopped.\");\n  }\n}\n\n// --- Main execution ---\nwindow.addEventListener(\"load\", () => {\n  const canvas = document.getElementById(\"mondrianCanvas\") as HTMLCanvasElement;\n  if (!canvas) {\n    console.error(\"Canvas element not found!\");\n    return;\n  }\n\n  const toneGenerator = new ToneGenerator(canvas);\n\n  // Setup start button\n  const startButton = document.getElementById(\"startButton\");\n  if (startButton) {\n    startButton.addEventListener(\"click\", () => {\n      toneGenerator.start();\n      startButton.style.display = \"none\";\n    });\n  }\n\n  // Setup volume control\n  const volumeSlider = document.getElementById(\n    \"volumeSlider\"\n  ) as HTMLInputElement;\n  const volumeValue = document.getElementById(\"volumeValue\");\n  if (volumeSlider && volumeValue) {\n    volumeSlider.addEventListener(\"input\", () => {\n      const volume = parseInt(volumeSlider.value, 10);\n      volumeValue.textContent = `${volume}%`;\n      toneGenerator.setVolume(volume);\n    });\n  }\n\n  // Setup speed control\n  const speedSlider = document.getElementById(\n    \"speedSlider\"\n  ) as HTMLInputElement;\n  const speedValue = document.getElementById(\"speedValue\");\n  if (speedSlider && speedValue) {\n    speedSlider.addEventListener(\"input\", () => {\n      const speed = parseFloat(speedSlider.value);\n      speedValue.textContent = `${speed.toFixed(1)}s`;\n      toneGenerator.setInterval(speed);\n    });\n  }\n});\n"],
  "mappings": "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",
  "names": []
}
